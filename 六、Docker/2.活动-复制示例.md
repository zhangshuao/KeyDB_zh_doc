# Active Replication 活动复制入门

## 建立网络，运行活动副本服务器，连接客户端并测试

### 为我们的docker容器建立一个网络。

    $ docker network create mynetwork

您可以使用 $docker network ls 查看网络

### 发起nodes节点

    $ docker run --name mynode1 --net mynetwork eqalpha/keydb

### 要使用自定义配置文件启动:

    $ docker run -v /path-to-config-file/redis.conf:/etc/keydb/redis.conf --net mynetwork --name mynode1 -d eqalpha/keydb

### 要启动并更新当前配置文件，请执行以下操作:

    $ docker run --net mynetwork --name mynode1 -d eqalpha/keydb keydb-server /etc/keydb/redis.conf --active-replica yes
    
### 更新从github页面获得的redis.config 或 使用本例中包含的更新版本时，以下内容可能会有所帮助：

注释"bind 127.0.0.1"，将"protected mode"从"yes"更改为"no"。如果要启用活动副本支持，请取消注释"active-replica yes"。

### 要获取刚才创建的节点的IP地址:

    $ docker inspect -f '{{ (index .NetworkSettings.Networks "mynetwork").IPAddress }}' mynode1

如果要运行客户端以连接到此网络上的节点：

    $ docker run -it --net mynetwork eqalpha/keydb keydb-cli -h <ip-address-of-node> -p 6379

### Test测试:

尝试创建两个节点，然后按上述方式将一个客户端连接到每个节点。
使用keydb-cli连接到keydb服务器后，调用每个节点作为另一个节点的副本, 通过 REPLICAOF <your node ip address>:6379
一旦两个节点都是每个节点的副本，您就可以将SET testval1 hello写入一个client，然后在下一个client write GET testval1上，您将看到响应"hello"。


