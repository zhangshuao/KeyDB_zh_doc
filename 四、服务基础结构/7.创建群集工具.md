# 使用创建集群工具

## 使用创建群集工具

克隆github文件夹后，可以导航到utils/create-cluster。这意味着您已经编译了程序，并且已经在src文件夹中构建了二进制文件。

您可以看到此脚本的readme自述文件，但是我们将使用此实用程序进行快速设置

如果不想编辑create-cluster.sh，则可以在此文件夹中创建config.sh脚本。如果存在，则将使用此脚本而不是默认脚本。

无论是创建自己的配置文件还是编辑create-cluster.sh的顶部，您将更新的值是：

    PORT=30000  -->this is the starting port number to use for the cluster, however script may start at +1 so nodes would be 30001-30006 instead of 30000-30005. for purposes of this tutorial user PORT=29999 
    TIMEOUT=2000    -->timeout setting
    NODES=6     -->the number of nodes in the cluster (port numbers incrementing from PORT setting)
    REPLICAS=1  -->number of replicas. here we want one replica created for each master instance

如果我们指定6个节点，每个主节点有一个副本，那么对于这个集群设置，我们最终将得到3个主节点和3个副本/从节点。

只需启动（启动群集实例。。。使用自动附加的配置文件运行keydb-server实例，而不是创建sperate）并创建群集（keydb-cli --cluster create 127.0.0.1:30000 127.0.0.1:30001 127.0.0.1:30002 127.0.0.1:30003 127.0.0.1:30004 127.0.0.1:30005 --cluster-replicas 1）：

    ./create-cluster start
    ./create-cluster create

您将看到在这个文件夹中有一堆群集节点和文件。

要停止群集：

    ./create-cluster stop

要清除此文件夹中的文件：

    ./create-cluster clean

## 测试群集设置

以群集模式（-c）将keydb-cli连接到端口30000，然后尝试以下操作：

    $ redis-cli -c -p 30000
    redis 127.0.0.1:30000> set foo bar
    -> Redirected to slot [12182] located at 127.0.0.1:30002
    OK
    redis 127.0.0.1:30002> set hello world
    -> Redirected to slot [866] located at 127.0.0.1:30000
    OK
    redis 127.0.0.1:30000> get foo
    -> Redirected to slot [12182] located at 127.0.0.1:30002
    "bar"
    redis 127.0.0.1:30000> get hello
    -> Redirected to slot [866] located at 127.0.0.1:30000
    "world"

