# 除了RAM之外，还使用非易失性存储器

## 关于闪存

DRAM的每GB成本明显高于闪存等非易失性存储器。启用时，KeyDB可以将访问频率较低的数据存储在非易失性存储器中，而不是RAM中。
必要时，KeyDB会主动地将数据从非易失性存储器中调出或调出。当然，您也可以使用普通旋转磁盘，但不建议使用，因为性能会很差。
KeyDB希望底层设备具有良好的随机I/O性能。

闪存仅用于临时数据，其性能与RAM类似。坚持仍然是通过正常的机制来实现的。当使用"free"命令查看内存时，KeyDB使用的内存将显示为"buff/cache"。
KeyDB依赖于内核的分页策略来决定将什么放在磁盘上。

## 系统要求

KeyDB依赖文件系统快照来保持数据备份的快速高效。因此，您必须使用具有快照支持的文件系统，如BTRFS或ZFS。
另外，因为这个特性有一点开销，所以必须在编译时启用它。此功能在中编译的Docker镜像可用。
有关如何在启用此功能的情况下从源代码生成的详细信息，请参阅编译部分。

## 配置文件

将添加一个新的配置选项，该选项将启用此功能并确定暂存文件的位置。这必须是启用快照的文件系统上目录的路径。
KeyDB将在此目录中创建一个临时文件，该文件将在程序关闭时自动删除。

    scratch-file-path /path

注意：由于自动删除的工作方式，您可能看不到此目录中带有"ls"的文件。"df"命令和"lsof"命令可用于获取有关此文件磁盘使用情况的更好信息。

## 编译

编译malloc时，必须使用以下命令将其设置为"memkind"：

    make MALLOC=memkind

