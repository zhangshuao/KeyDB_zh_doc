# 如果您从未使用过KeyDB或KeyDB...

如果您以前从未使用过KeyDB或KeyDB，但希望使用某些命令进行操作，请安装KeyDB，然后运行服务器。

下面一行要求在加载默认配置文件的情况下运行服务器。'--' 修改配置参数。
在这里，为了测试，我们禁用了保护模式（特别是在端口暴露的情况下，不建议这样做——理想情况下是保护这个实例）。
因为我们将在同一个节点上使用环回来运行客户机，所以我们将保持简单。
我们还对其进行守护，以便它在后台运行，如果你没有多个命令提示窗口打开。

    keydb-server --protected-mode no --daemonize yes
    
现在连接到客户端：

    keydb-cli -p 6379

现在可以开始发送命令，如set、get等。。。命令的完整列表可以在命令部分看到。
要正确设置，建议您查看下面显示的配置文件，以查看与自定义安全设置相关的选项。
 
## 再详细一点...

* 阅读以下内容有助于您:
* 使用keydb cli访问服务器。
* 从应用程序中使用KeyDB。
* 了解KeyDB持久性的工作原理。
* 正确安装KeyDB。
* 找出下一步要阅读的内容，以了解有关KeyDB的更多信息。

构建项目后，可以通过键入make test来测试构建是否正常工作，但这是一个可选步骤。
编译后，KeyDB发行版中的src目录将填充KeyDB中的不同可执行文件：

* keydb-server是keydb服务器本身。
* keydb-sentinel是keydb-sentinel可执行文件（监视和故障转移）。
* keydb-cli是与keydb对话的命令行界面实用程序。
* keydb-benckmark用于检查keydb性能。
* keydb-check-aof 和 keydb-check-dump在数据文件损坏的罕见情况下非常有用。

最好在适当的位置同时复制KeyDB服务器和命令行界面，可以使用以下命令手动复制：

    sudo cp src/keydb-server /usr/local/bin/
    sudo cp src/keydb-cli /usr/local/bin/

或者只是使用 sudo make install。
在下面的文档中，我们假设/usr/local/bin位于您的PATH环境变量中，这样您就可以在不指定完整路径的情况下执行这两个二进制文件。
 
## 开始 KeyDB
启动KeyDB服务器的最简单方法是不带任何参数地执行KeyDB服务器二进制文件。

    $ keydb-server
    [28550] 01 Aug 19:29:28 # Warning: no config file specified, using the default config. In order to specify a config file use 'keydb-server /path/to/redis.conf'
    [28550] 01 Aug 19:29:28 * Server started, KeyDB version 2.2.12
    [28550] 01 Aug 19:29:28 * The server is now ready to accept connections on port 6379
    ... more logs ...

在上面的示例中，KeyDB是在没有任何显式配置文件的情况下启动的，因此所有参数都将使用内部默认值。
如果启动KeyDB只是为了使用它或用于开发，那么这是非常好的，但是对于生产环境，您应该使用配置文件。

要使用配置文件启动KeyDB，请使用配置文件的完整路径作为第一个参数，如以下示例所示：keydb-server /etc/redis.conf。应使用KeyDB源代码分发的根目录中包含的redis.conf文件作为模板来编写配置文件

## 检查KeyDB是否工作

外部程序使用TCP套接字和KeyDB特定协议与KeyDB通信。该协议在不同编程语言的KeyDB客户端库中实现。
不过，为了使KeyDB的黑客操作更简单，KeyDB提供了一个命令行实用程序，可用于向KeyDB发送命令。这个程序叫做keydb-cli。

要检查KeyDB是否正常工作，首先要使用KeyDB cli发送PING命令：

    $ keydb-cli ping
    PONG
    
运行keydb-cli，后跟命令名及其参数，将此命令发送到在6379端口的本地主机上运行的keydb实例。
您可以更改keydb-cli使用的主机和端口，只需尝试--help选项来检查使用信息。

运行keydb-cli的另一个有趣的方法是不带参数：程序将以交互模式启动，您可以键入不同的命令并查看它们的回复。

    $ keydb-cli                                                                
    KeyDB 127.0.0.1:6379> ping
    PONG
    KeyDB 127.0.0.1:6379> set mykey somevalue
    OK
    KeyDB 127.0.0.1:6379> get mykey
    "somevalue"

此时，您可以与KeyDB交谈。在本教程中暂停一下，开始介绍KeyDB数据类型15分钟，以便学习一些KeyDB命令是正确的。
否则，如果您已经知道一些基本的KeyDB命令，您可以继续阅读。


## KeyDB 安全

默认情况下，KeyDB绑定到所有接口，根本没有身份验证。如果您在一个非常受控制的环境中使用KeyDB，与外部互联网分离，并且通常与攻击者分离，那就没问题了。
然而，如果KeyDB没有任何强化就暴露在互联网上，这是一个很大的安全问题。如果您不能100%确定您的环境是否安全，请检查以下步骤以使KeyDB更加安全，这些步骤是为了提高安全性而登记的。

1、确保KeyDB用于侦听连接的端口（默认情况下为6379，如果在群集模式下运行KeyDB，则为16379，如果在Sentinel模式下运行KeyDB，则为26379）是防火墙，因此无法从外部世界联系KeyDB。
2、使用设置了bind指令的配置文件，以确保KeyDB只在您使用的少量网络接口中监听。例如，如果您仅从同一台计算机本地访问KeyDB，则仅使用环回接口（127.0.0.1），以此类推。
3、使用requirepass选项添加额外的安全层，以便客户端需要使用AUTH命令进行身份验证。
4、如果您的环境需要加密，请使用spiped或其他SSL隧道软件加密KeyDB服务器和KeyDB客户端之间的通信。

## 从应用程序中使用KeyDB

当然，仅仅从命令行界面使用KeyDB是不够的，因为目标是从应用程序中使用它。
为此，您需要下载并安装用于编程语言的KeyDB客户端库。您将在本页中找到一个完整的redis客户端列表，这些客户端也适用于不同语言的KeyDB。

## KeyDB 持久化

您可以在Commands/Persistence文档中了解更多信息，但是对于快速启动来说，重要的是，默认情况下，如果使用默认配置启动KeyDB，KeyDB将不时地自动保存数据集（例如，如果数据中至少有100个更改，则至少在5分钟后保存），
因此，如果希望数据库持久化并在重新启动后重新加载，请确保在每次强制数据集快照时手动调用SAVE命令。
否则，请确保使用shutdown命令关闭数据库：

    $ keydb-cli shutdown

这样KeyDB将确保在退出之前将数据保存在磁盘上。

## 正确安装 KeyDB

从命令行运行KeyDB很好，只需对其进行一些修改或用于开发。但是，在某个时刻，您将有一些实际的应用程序在真正的服务器上运行。对于这种用法，您有两种不同的选择：

    * 使用screen运行KeyDB。
    * 使用init脚本以正确的方式在Linux框中安装KeyDB，这样在重新启动之后，一切都将重新正常启动。

强烈建议使用init脚本正确安装。以下说明可用于在基于Debian或Ubuntu的发行版中使用KeyDB 2.4附带的init脚本执行正确的安装。

我们假设您已经在/usr/local/bin下复制了keydb-server和keydb-cli可执行文件

* 创建存储KeyDB配置文件和数据的目录：

    sudo mkdir /etc/KeyDB
    sudo mkdir /var/KeyDB

* 将在utils目录下的KeyDB发行版中找到的init脚本复制到/etc/init.d中。我们建议用运行KeyDB实例的端口名调用它。例如：

    sudo cp utils/KeyDB_init_script /etc/init.d/KeyDB_6379
 
* 编辑init脚本。

    sudo vi /etc/init.d/KeyDB_6379

请确保根据正在使用的端口相应地修改 **KeyDBPORT**。pid文件路径和配置文件名都取决于端口号。     
     
* 使用端口号作为名称，将KeyDB发行版根目录中的模板配置文件复制到/etc/KeyDB/中，例如：

    sudo cp redis.conf /etc/KeyDB/6379.conf
  
* 在/var/KeyDB中创建一个目录，该目录将用作此KeyDB实例的数据和工作目录：

    sudo mkdir /var/KeyDB/6379

* 编辑配置文件，确保执行以下更改：

    * 将**daemonize**设置为yes（默认设置为no）。
    * 将**pidfile**设置为/var/run/KeyDB_6379.pid（如果需要，请修改端口）。
    * 相应地更改**port**。在我们的示例中，不需要它，因为默认端口已经是6379。
    * 设置首选**loglevel**。
    * 将**logfile**设置为/var/log/KeyDB_.log
    * 将**dir**设置为/var/KeyDB/6379（非常重要的步骤！）

* 最后，使用以下命令将新的KeyDB init脚本添加到所有默认运行级别.

    sudo update-rc.d KeyDB_6379 defaults

你完成后！现在您可以尝试使用以下命令运行实例：

    sudo /etc/init.d/KeyDB_6379 start
    
确保一切按预期工作：

    * 尝试使用keydb-cli ping您的实例。
    * 使用keydb-cli save执行测试保存，并检查转储文件是否正确存储到/var/keydb/6379/（您应该找到一个名为dump.rdb的文件）
    * 检查KeyDB实例是否正确地登录到日志文件中。
    * 如果这是一台新机器，你可以毫无问题地试用它，请确保在重新启动后一切仍在工作。

注意：在上面的说明中，我们跳过了许多您想要更改的KeyDB配置参数，例如为了使用AOF持久性而不是RDB持久性，或者设置复制等等。
请务必阅读示例redis.conf文件（该文件有大量注释）和其他文档，以获取更多信息。
